<!DOCTYPE html>
<html>
<head>
    <title>Excel Preview Button</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <link rel="stylesheet" href="https://p.trellocdn.com/power-up.min.css">
    <style>
        #preview-button { width:100%; height:34px; background:#0079bf; color:white; border:none; cursor:pointer; font-size:12px; padding:0; margin:0; }
    </style>
</head>
<body style="margin:0; padding:0;">
    <button id="preview-button">Preview Excel</button>
    <script>
        var t = window.TrelloPowerUp.iframe();
        t.render(function() {
            document.getElementById('preview-button').addEventListener('click', function(event) {
                var attUrl = t.arg('attUrl');
                t.popup({
                    title: 'Excel Preview',
                    url: t.signUrl('/preview.html', { attUrl: attUrl }), // Змінено на відносний URL для фіксу попередження
                    height: 600,
                    mouseEvent: event
                });
            });
            t.sizeTo('#preview-button');
        });
    </script>
</body>
</html>
