<!DOCTYPE html>
<html>
<head>
    <title>Excel Preview Connector</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
    <script>
        window.TrelloPowerUp.initialize({
            'attachment-thumbnail': function(t, options) {
                var attachments = options.entries;
                return attachments.map(function(attachment) {
                    if (attachment.name.endsWith('.xlsx') || attachment.name.endsWith('.xls')) {
                        return {
                            url: 'https://e7.pngegg.com/pngimages/468/231/png-clipart-xls-microsoft-excel-spreadsheet-computer-icons-microsoft-template-text.png', // Стандартна іконка Excel
                            title: 'Preview Excel',
                            contentType: 'image/png', // Тип для іконки
                            action: {
                                callback: function(t) {
                                    t.popup({
                                        title: 'Excel Preview',
                                        url: t.signUrl('https://trello-excel-preview.vercel.app/preview.html', { attUrl: attachment.url }),
                                        height: 600,
                                        fullscreen: true // Повноекранна модалка для всього документа
                                    });
                                }
                            }
                        };
                    }
                }).filter(Boolean);
            }
        });
    </script>
</body>
</html>
