<!DOCTYPE html>
<html>
<head>
    <title>Excel Preview Connector</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
    <script>
        window.TrelloPowerUp.initialize({
            'attachment-sections': function(t, options) {
                var attachments = options.entries;
                return attachments
                    .filter(function(attachment) {
                        return attachment.name.endsWith('.xlsx') || attachment.name.endsWith('.xls');
                    })
                    .map(function(attachment) {
                        return {
                            id: 'excel-preview-' + attachment.id, // Унікальний ID для кожної секції
                            claimed: [attachment], // Обов'язкове: масив з attachments, які ця секція обробляє
                            title: 'Excel Preview: ' + attachment.name, // Тайтл з назвою файлу для ясності
                            icon: 'https://oonufrienko.github.io/trello-excel-preview/icon.png', // URL сірої іконки
                            content: {
                                type: 'iframe',
                                url: t.signUrl('https://oonufrienko.github.io/trello-excel-preview/preview.html'),
                                height: 400 // Початкова висота
                            }
                        };
                    });
            }
        });
    </script>
</body>
</html>
