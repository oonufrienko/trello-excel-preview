<!DOCTYPE html>
<html>
<head>
    <title>Excel Preview Connector</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
    <script>
        window.TrelloPowerUp.initialize({
            'attachment-thumbnail': function(t, options) {
                var attachment = options.entries[0]; // Для thumbnail це один attachment
                if (attachment.name.endsWith('.xlsx') || attachment.name.endsWith('.xls')) {
                    return {
                        url: 'https://your-vercel-app.vercel.app/icon-excel.png', // URL на іконку Excel (створіть grayscale іконку і завантажте на Vercel)
                        title: 'Excel Preview',
                        action: {
                            text: 'View Excel',
                            callback: function(t) {
                                t.popup({
                                    title: 'Excel Viewer',
                                    url: t.signUrl('https://trello-excel-preview.vercel.app/preview.html', { attUrl: attachment.url }),
                                    height: 600, // Висота модалки
                                    fullscreen: true // Повноекранний режим для кращого перегляду
                                });
                            }
                        }
                    };
                }
            }
        });
    </script>
</body>
</html>
