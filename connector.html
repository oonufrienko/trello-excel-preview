<!DOCTYPE html>
<html>
<head>
    <title>Excel Preview Connector</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
    <script>
        window.TrelloPowerUp.initialize({
            'attachment-sections': function(t, options) {
                var attachments = options.entries;
                return attachments
                    .filter(function(attachment) {
                        return attachment.name.endsWith('.xlsx') || attachment.name.endsWith('.xls');
                    })
                    .map(function(attachment) {
                        return {
                            id: 'excel-preview-' + attachment.id,
                            claimed: [attachment],
                            title: 'Excel Preview',
                            icon: 'https://trello-excel-preview.vercel.app/icon.png', // Якщо є сіра іконка
                            content: {
                                type: 'iframe',
                                url: t.signUrl('https://trello-excel-preview.vercel.app/preview-button.html', { attUrl: attachment.url }),
                                height: 60 // Компактна висота для кнопки, щоб не ламати картку
                            }
                        };
                    });
            }
        });
    </script>
</body>
</html>
